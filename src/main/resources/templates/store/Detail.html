<!DOCTYPE html>

<html lang="ko">

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>게시물 상세보기 화면</title>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="canonical" href="https://getbootstrap.kr/docs/5.3/examples/jumbotrons/">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@4.5.2/dist/lux/bootstrap.min.css"
        integrity="sha384-9+PGKSqjRdkeAU7Eu4nkJU8RFaH8ace8HGXnkiKMP9I9Te0GJ4/km3L1Z8tXigpG" crossorigin="anonymous">

    <style>
        .navbar-brand {
            margin-right: 50px;
            font-size: 25px;
        }

        /* Bootstrap Style (https://getbootstrap.kr/) */
        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }

        .b-example-divider {
            width: 100%;
            height: 3rem;
            background-color: rgba(0, 0, 0, .1);
            border: solid rgba(0, 0, 0, .15);
            border-width: 1px 0;
            box-shadow: inset 0 .5em 1.5em rgba(0, 0, 0, .1), inset 0 .125em .5em rgba(0, 0, 0, .15);
        }

        .b-example-vr {
            flex-shrink: 0;
            width: 1.5rem;
            height: 100vh;
        }

        .bd-mode-toggle {
            z-index: 1500;
        }

        .b-example-divider {
            height: 20px;
        }

        .container.my-5 {
            height: 300px;
        }

        .my-5 {
            height: 300px;
            margin-top: 20px !important;
        }

        .my-5-container .my-5 {
            height: 250px;
        }

        .container.py-5 img {
            max-width: 100%;
            height: auto;
            display: block;
        }

        .container.my-5 img {
            max-width: 100%;
            height: auto;
            display: block;
        }
        body{
      color: black;
    font-weight: bold;
    }
    </style>

</head>

<body style="height: 1000px;">
    <nav class="navbar navbar-dark bg-dark" aria-label="Dark offcanvas navbar">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">TeamProject</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas"
                data-bs-target="#offcanvasNavbarDark" aria-controls="offcanvasNavbarDark" aria-label="Toggle navigation"
                style="border: none; box-shadow: none;">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-list-ul"
                    viewBox="0 0 16 16" style="color: white;">
                    <path fill-rule="evenodd"
                        d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2z" />
                </svg>
            </button>
            <div class="offcanvas offcanvas-end text-bg-dark" tabindex="-1" id="offcanvasNavbarDark"
                aria-labelledby="offcanvasNavbarDarkLabel" style="background-color: #212529;">
                <div class="offcanvas-header">
                    <h5 class="offcanvas-title" id="offcanvasNavbarDarkLabel" style="color: white;">TeamProject</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"
                        aria-label="Close"></button>
                </div>
                <div class="offcanvas-body">
                    <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                        <li class="nav-item">
                            <div>
                                <div th:if="${session.user_info != null}">
                                    <svg id="edit-profile-icon" xmlns="http://www.w3.org/2000/svg" width="28"
                                        height="28" fill="currentColor" class="bi bi-person-fill mb-2"
                                        viewBox="0 0 16 16" style="cursor: pointer; color: white;">
                                        <path
                                            d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3Zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" />
                                    </svg>
                                    <p th:text="${session.user_info}" style="color: white;"></p>
                                </div>
                                <div th:unless="${session.user_info != null }">
                                </div>
                                <div>
                                    <a th:if="${session.user_info == null}" th:href="@{/login}" class=="nav-link active"
                                        aria-current="page"
                                        style="text-decoration: none; color: white; font-weight: bold;">로그인</a>
                                    <a th:if="${session.user_info == null}" th:href="@{/signup}"
                                        class=="nav-link active" aria-current="page"
                                        style="text-decoration: none; color: white; font-weight: bold; margin-left: 10px;">회원가입</a>
                                </div>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/store/list">게시판</a>
                        </li>
                        <li class="nav-item">
                            <a th:if="${session.user_info != null}" href="/logout" class="nav-link active"
                                aria-current="page">로그아웃</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

    <div class="container my-5" style="display: flex; justify-content: center; height: 800px;">
        <div class="p-5 text-center bg-body-tertiary rounded-3">
            <div class="container row gx-5" style="width: 1300px; height: 550px; max-width: 1340px;">
                <div class="container col-6">
                    <div>
                        <div class="container text-center">
                            <br />
                            <div class="row row-cols-4">
                                <div class="col">
                                    <h2 style="width: 300px;" th:text="${store.name}"></h2>
                                    <img src="" alt="image" style="visibility: hidden;" />
                                </div>
                            </div>
                            <input type="text" id="address" placeholder="주소를 입력하세요"
                                th:value="${store.streetNameAddress}" hidden>
                            <button id="search" hidden>검색</button>
                            <div id="map" style="width:450px; height:400px; margin-top: 10px;"></div>
                        </div>
                    </div>
                </div>
                <div class="container col-6">
                    <div>
                        <table class="table">

                            <thead>
                                <tr>
                                    <th scope="row" colspan="3">제목</th>
                                    <th scope="col" colspan="1">작성자</th>
                                    <th scope="col" colspan="1">날짜</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:each="board : ${list}" th:attr="id=${board.id}">
                                    <th scope="row" colspan="3">
                                        <a th:href="@{/store/comment/{id}(id=${board.id})}"
                                            style="text-decoration: none">[[${board.title}]]</a>
                                    </th>
                                    <td th:text="${board.user.name}"></td>                                
                                    <td th:text="${#dates.format(board.registrationDateBoard, 'yy.MM.dd-HH:mm:ss')}"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>
            <a th:href="@{/store/write/{id}(id=${store.id})}"><button type="button" class="btn btn-primary mb-4" style="margin-left: 1000px";> 리뷰 쓰기
                </button></a>
        </div>
    </div>

    <div class="container-footer" style="width: 1300px; height: auto; margin: auto;">
        <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top">
            <p class="col-md-4 mb-0 text-body-secondary">&copy; Produced in 2023</p>
            <a href="/"
                class="col-md-4 d-flex align-items-center justify-content-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none">
            </a>
            <ul class="nav col-md-4 justify-content-end">
                <li class="nav-item">
                    <a href="#" class="nav-link px-2 text-body-secondary" style="color: black;">Team (박준우, 김성민, 이상준)</a>
                </li>
            </ul>
        </footer>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            let editProfile = document.getElementById("edit-profile-icon")
            editProfile.addEventListener("click", function () {
                location.href = '/manage';
            })

        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>

    <script type="text/javascript"
        src="//dapi.kakao.com/v2/maps/sdk.js?appkey=9b54861d0c93000a3e6defaa4159c4f5&libraries=services"></script>

    <script>
        var searchButton = document.getElementById('search');
        var coords; searchButton.addEventListener('click', function () {
            var address = document.getElementById('address').value;
            var geocoder = new kakao.maps.services.Geocoder();
            geocoder.addressSearch(address, function (result, status) {
                if (status === kakao.maps.services.Status.OK) {
                    coords = new kakao.maps.LatLng(result[0].y, result[0].x);
                    console.log('주소: ' + address);
                    console.log('위도: ' + coords.getLat());
                    console.log('경도: ' + coords.getLng());
                    var map = new kakao.maps.Map(container, { center: coords, level: 2 });
                    var marker = new kakao.maps.Marker({ position: coords });
                    marker.setMap(map);
                    var storeName = `[[${store.name}]]`;
                    var iwContent = '<div style="padding:10px; font-weight:bold"><strong>' + storeName + '</strong></div>',
                        iwPosition = new kakao.maps.LatLng(coords.getLat() + 0.00015, coords.getLng()),
                        iwRemoveable = true;
                    var infowindow = new kakao.maps.InfoWindow({
                        map: map, position: iwPosition, content: iwContent, removable: iwRemoveable
                    });
                } else {
                    console.log('주소 검색에 실패하였습니다. 다시 시도해주세요.');
                }
            });
        });
        var container = document.getElementById('map');
        var options = {
            center: new kakao.maps.LatLng(37.566826, 126.9786567), level: 2
        };
        var map = new kakao.maps.Map(container, options);
        if (document.getElementById('address').value !== '') {
            searchButton.click();
        } 
    </script>

</body>

</html>